<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Danh sách mùa giải</title>
    <!-- Link CSS của bạn (có thể là file dùng chung với trang addseason) -->
    <link rel="stylesheet" href="styles.css" />
    <!-- Ví dụ tên file CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <!-- Font Awesome -->
    <style>
      /* --- CSS CHO CARD MÙA GIẢI (Dựa theo hình ảnh) --- */
      body {
        background-color: #ecf0f5; /* Màu nền giống trang gốc */
        font-family: Oswald, sans-serif; /* Font giống trang gốc */
      }
      .page-container {
        /* Optional: Bao bọc nội dung chính */
        padding: 20px;
      }
      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0 20px 0;
        border-bottom: 3px solid #d2d6de;
        margin-bottom: 20px;
        color: #333;
      }
      .page-header h1 {
        margin: 0;
        font-size: 24px;
        font-weight: normal; /* Giống style gốc */
      }
      .page-header h1 i {
        color: #dd4b39;
        margin-right: 5px;
      } /* Màu icon giống gốc */

      .add-button {
        background-color: #00c0ef; /* Màu xanh dương */
        color: white;
        padding: 8px 15px;
        border: none;
        border-radius: 3px;
        cursor: pointer;
        text-decoration: none;
        font-size: 14px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
      }
      .add-button:hover {
        background-color: #00a3cb;
      }
      .add-button i {
        margin-right: 5px;
      }

      .cards-container {
        display: flex; /* Hoặc grid */
        flex-wrap: wrap;
        gap: 20px; /* Khoảng cách giữa các card */
      }

      .season-card {
        background-color: #fff;
        border-radius: 5px;
        width: 300px; /* Điều chỉnh chiều rộng nếu cần */
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        overflow: hidden; /* Để bo góc hoạt động */
        display: flex;
        flex-direction: column;
      }

      .season-card .card-header {
        position: relative;
        height: 150px; /* Chiều cao ảnh nền */
      }
      .season-card .card-header .wallpaper {
        width: 100%;
        height: 100%;
        object-fit: cover; /* Đảm bảo ảnh nền che phủ */
        display: block;
      }
      /* Nút xem ảnh (tùy chọn) */
      .season-card .view-image-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .season-card .card-logo-container {
        display: flex;
        justify-content: center;
        margin-top: -40px; /* Kéo logo lên */
        position: relative; /* Để logo đè lên ảnh nền */
        z-index: 1;
      }
      .season-card .card-logo {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        border: 3px solid white;
        object-fit: cover;
        background-color: #eee; /* Màu nền nếu logo trong suốt */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .season-card .card-body {
        padding: 15px;
        text-align: center;
        flex-grow: 1; /* Để đẩy footer xuống dưới */
        margin-top: 5px; /* Khoảng cách với logo */
      }
      /* Bỏ tên mùa giải nếu không có trong hình ảnh mẫu */
      /* .season-card .card-body h3 {
          margin: 10px 0;
          font-size: 1.1em;
        } */

      .season-card .card-info {
        text-align: left;
        font-size: 14px;
        color: #555;
        margin-top: 10px;
      }
      .season-card .card-info p {
        margin: 8px 0;
      }
      .season-card .card-info i {
        margin-right: 8px;
        color: #777;
        width: 15px; /* Căn chỉnh icon */
      }
      .season-card .card-extra-info {
        /* Dòng số màu đỏ */
        color: #dd4b39;
        font-weight: bold;
        margin-top: 10px;
        font-size: 16px;
      }

      .season-card .card-footer {
        display: flex;
        border-top: 1px solid #f4f4f4;
      }
      .season-card .card-footer button {
        flex: 1;
        padding: 10px;
        border: none;
        background-color: transparent;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.2s;
      }
      .season-card .card-footer button:first-child {
        border-right: 1px solid #f4f4f4;
      }
      .season-card .card-footer button.edit-btn {
        background-color: #9ccc65; /* Màu xanh lá nhạt */
        color: white;
      }
      .season-card .card-footer button.edit-btn:hover {
        background-color: #8bc34a;
      }
      .season-card .card-footer button.delete-btn {
        background-color: #e57373; /* Màu đỏ nhạt */
        color: white;
      }
      .season-card .card-footer button.delete-btn:hover {
        background-color: #ef5350;
      }
      /* --- KẾT THÚC CSS CARD --- */

      /* CSS Footer (copy từ trang addseason nếu cần) */
      .footer {
        /* ... */
      }
      .footer-container {
        /* ... */
      }
      /* ... */
    </style>
  </head>
  <body>
    <!-- (Optional) Thêm Header và Sidebar giống trang addseason.html ở đây -->

    <div class="page-container">
      <!-- Bao nội dung chính -->
      <div class="page-header">
        <h1><i class="fas fa-list"></i> Danh sách mùa giải</h1>
        <a href="addseason.html" class="add-button"
          ><i class="fas fa-plus"></i> Thêm mới</a
        >
      </div>

      <div class="cards-container" id="seasonListContainer">
        <!-- Các card mùa giải sẽ được JS chèn vào đây -->
        <p id="noSeasonsMessage" style="display: none">
          Chưa có mùa giải nào được tạo.
        </p>
      </div>
    </div>

    <!-- (Optional) Thêm Footer giống trang addseason.html ở đây -->

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const container = document.getElementById("seasonListContainer");
        const noSeasonsMessage = document.getElementById("noSeasonsMessage");
        const seasonsDataKey = "danhSachMuaGiai"; // Phải giống key đã lưu

        try {
          const seasons =
            JSON.parse(localStorage.getItem(seasonsDataKey)) || [];

          if (seasons.length === 0) {
            noSeasonsMessage.style.display = "block"; // Hiện thông báo nếu không có dữ liệu
            return; // Dừng nếu không có mùa giải
          }

          noSeasonsMessage.style.display = "none"; // Ẩn thông báo nếu có dữ liệu
          container.innerHTML = ""; // Xóa nội dung cũ (nếu có)

          seasons.forEach((season) => {
            // Định dạng lại ngày tháng (ví dụ: DD-MM-YYYY)
            const formatDate = (dateString) => {
              if (!dateString) return "N/A";
              const date = new Date(dateString);
              const day = String(date.getDate()).padStart(2, "0");
              const month = String(date.getMonth() + 1).padStart(2, "0"); // Tháng bắt đầu từ 0
              const year = date.getFullYear();
              return `${day}-${month}-${year}`;
            };

            const cardHTML = `
                        <div class="season-card" data-id="${season.id}">
                            <div class="card-header">
                                ${
                                  season.wallpaper
                                    ? `<img src="${season.wallpaper}" alt="Hình nền" class="wallpaper">`
                                    : '<div style="height: 100%; background-color: #ccc;"></div>'
                                }
                                <!-- <button class="view-image-btn"><i class="fas fa-camera"></i></button> -->
                            </div>
                            <div class="card-logo-container">
                                 ${
                                   season.logo
                                     ? `<img src="${season.logo}" alt="Logo" class="card-logo">`
                                     : '<div class="card-logo" style="background-color: #ddd; display:flex; align-items:center; justify-content:center; font-size:12px; color:#666;">No Logo</div>'
                                 }
                            </div>
                            <div class="card-body">
                                <!-- <h3>${
                                  season.name
                                }</h3> --> <!-- Tên mùa giải, nếu cần -->
                                <div class="card-info">
                                    <p><i class="far fa-calendar-alt"></i> Từ ${formatDate(
                                      season.startDate
                                    )} đến ${formatDate(season.endDate)}</p>
                                    <p><i class="fas fa-users"></i> Đội tham dự: ${
                                      season.teamCount || "N/A"
                                    }</p>
                                    <!-- Thêm các thông tin khác nếu có -->
                                     ${
                                       season.location
                                         ? `<p><i class="fas fa-map-marker-alt"></i> ${season.location}</p>`
                                         : ""
                                     }
                                     ${
                                       season.fanpage
                                         ? `<p><i class="fab fa-facebook-square"></i> <a href="${season.fanpage}" target="_blank">${season.fanpage}</a></p>`
                                         : ""
                                     }
                                </div>
                                 <div class="card-extra-info">
                                     ${
                                       season.id % 1000
                                     } <!-- Hiển thị số giống ảnh mẫu (lấy 3 số cuối ID) -->
                                 </div>
                            </div>
                            <div class="card-footer">
                                <button class="edit-btn" onclick="editSeason(${
                                  season.id
                                })"><i class="fas fa-cog"></i></button>
                                <button class="delete-btn" onclick="deleteSeason(${
                                  season.id
                                })"><i class="fas fa-trash-alt"></i></button>
                            </div>
                        </div>
                    `;
            container.insertAdjacentHTML("beforeend", cardHTML);
          });
        } catch (error) {
          console.error("Lỗi khi tải dữ liệu từ localStorage:", error);
          container.innerHTML =
            "<p>Đã xảy ra lỗi khi tải danh sách mùa giải.</p>";
        }
      });

      // --- Các hàm xử lý nút Sửa/Xóa (Placeholder) ---
      function editSeason(seasonId) {
        console.log("Chức năng sửa cho mùa giải ID:", seasonId);
        alert("Chức năng Sửa chưa được cài đặt!");
        // Logic: Có thể chuyển hướng về trang addseason.html với ID để tải dữ liệu cũ lên form
        // window.location.href = `addseason.html?edit=${seasonId}`;
      }

      function deleteSeason(seasonId) {
        console.log("Chức năng xóa cho mùa giải ID:", seasonId);
        if (
          confirm(`Bạn có chắc chắn muốn xóa mùa giải này (ID: ${seasonId})?`)
        ) {
          try {
            const seasonsDataKey = "danhSachMuaGiai";
            let seasons =
              JSON.parse(localStorage.getItem(seasonsDataKey)) || [];
            // Lọc ra những mùa giải KHÔNG có ID trùng với ID cần xóa
            const updatedSeasons = seasons.filter(
              (season) => season.id !== seasonId
            );
            // Lưu lại danh sách mới vào localStorage
            localStorage.setItem(
              seasonsDataKey,
              JSON.stringify(updatedSeasons)
            );
            // Tải lại trang để cập nhật danh sách hiển thị
            location.reload();
          } catch (error) {
            console.error("Lỗi khi xóa mùa giải:", error);
            alert("Đã xảy ra lỗi khi xóa mùa giải.");
          }
        }
      }
    </script>
  </body>
</html>
