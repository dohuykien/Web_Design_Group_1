<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thông số trận đấu</title>
    <link rel="icon" type="logo.png" href="/images/logo.png" />
    <!-- Sửa nếu cần -->
    <link
      href="https://fonts.googleapis.com/css2?family=Oswald&display=swap"
      rel="stylesheet"
    />
    <!-- Source Sans Pro -->
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,300;0,400;0,600;0,700;1,400&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <!-- CSS Tham chiếu -->
    <link rel="stylesheet" href="/user/css/sidebar.css" />
    <link rel="stylesheet" href="/user/css/userheader.css" />
    <link rel="stylesheet" href="/user/css/userfooter.css" />
    <!-- ĐÃ BỎ CSS Nav đội bóng -->

    <!-- CSS Riêng cho trang này -->
    <style>
      /* Toàn bộ CSS của bạn từ trước được giữ nguyên ở đây */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: Oswald, sans-serif;
        text-decoration: none;
      }
      body {
        background-color: #ecf0f5;
      }
      /* Header Styles */
      .developed-by {
        position: absolute;
        left: 250px;
        top: 7px;
        color: #ffffff;
        font-size: 14px;
        z-index: 2;
      }
      .navbar-top {
        background-color: #1565c0;
        color: white;
        padding: 10px 20px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 75px;
      }
      .navbar-bottom {
        position: relative;
      }
      .logo {
        display: flex;
        align-items: center;
        z-index: 2;
        left: 170px;
      }
      .logo img {
        height: 65px;
        max-width: 100%;
        margin-right: 10px;
      }
      .navbar-collapse {
        background-color: #ff6f00;
        padding: 7px 0px;
        height: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        z-index: 1;
      }
      .navbar-collapse::before {
        content: "";
        position: absolute;
        top: -40px;
        left: -15px;
        width: 101%;
        height: 50px;
        background-color: #ff6f00;
        clip-path: polygon(0 350%, 15% 0, 100% 0, 100% 100%);
      }
      .navbar-nav {
        display: flex;
        margin-left: -200px;
      }
      .navbar-nav li a {
        left: 10px;
        color: white;
        text-decoration: none;
        top: -20px;
        position: relative;
        z-index: 2;
        font-size: 16px;
      }
      .nav-item {
        padding: 0 15px;
        list-style: none;
      }
      .navbar-nav a:hover {
        text-decoration: underline;
      }
      @media (max-width: 768px) {
        .navbar-collapse {
          display: none;
          flex-direction: column;
          width: 100%;
          background: #fff;
          position: absolute;
          top: 50px;
          left: 0;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .navbar-collapse.active {
          display: flex;
        }
        .nav-item {
          text-align: center;
          padding: 10px 0;
        }
      }
      .header .user-info {
        display: flex;
        align-items: center;
        gap: 10px;
        position: relative;
        right: 60px;
        top: -20px;
        cursor: pointer;
        z-index: 1000;
      }
      .header .user-info img {
        width: 30px;
        height: 30px;
      }
      .user-info span i {
        position: relative;
        top: -2px;
      }
      .dropdown-menu {
        display: none;
        position: absolute;
        top: 100%;
        right: 0;
        background-color: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        min-width: 160px;
        z-index: 1000;
        padding: 5px 0px;
      }
      .dropdown-menu a {
        display: block;
        padding: 5px 15px;
        color: #333333;
        text-decoration: none;
        transition: background-color 0.3s;
        font-size: 14px;
      }
      .dropdown-menu a:hover {
        background-color: #f34541;
        color: #ffffff;
      }
      .header .user-info .fa-solid.fa-caret-down {
        color: #333333;
        font-size: 12px;
      }
      /* Layout & Sidebar */
      .container {
        display: flex;
        width: 100%;
      }
      .sidebar {
        width: 230px;
        background: #333333;
        color: #b8c7ce;
        min-height: 648px;
        height: 100%;
        position: relative;
        bottom: 2px;
        z-index: 1;
      }
      .sidebar ul {
        list-style: none;
        background-color: #2c3b41;
      }
      .sidebar ul li {
        padding: 9px 5px 9px 10px;
        display: flex;
        align-items: center;
        gap: 10px;
        border-bottom: 1px solid #ffffff;
        cursor: pointer;
        transition: color 0.2s;
      }
      .sidebar ul li:hover {
        color: #ffffff;
      }
      .sidebar ul li i {
        width: 20px;
        text-align: center;
      }
      .sidebar a {
        text-decoration: none;
        flex: 1;
        color: #b8c7ce;
      }
      .sidebar a:hover {
        color: #ffffff;
      }
      .fa-solid.fa-tachometer-alt {
        color: #ff6f00;
      }
      .submenu {
        display: none;
        background: #ff6f00 !important;
      }
      .submenu li {
        padding: 12px 12px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        width: 100%;
        height: 32px;
      }
      .submenu a {
        color: #222222 !important;
      }
      .submenu li:hover {
        background: #ffffff;
      }
      .submenu a:hover {
        color: rgb(250, 55, 25) !important;
      }
      .menu-item.active + .submenu {
        display: block;
      }
      .menu-item {
        display: flex;
        align-items: center;
        padding: 15px 15px;
        cursor: pointer;
        width: 100%;
      }
      .menu-item i {
        margin-right: 10px;
      }
      .fa-solid.fa-play {
        font-size: 9px;
        color: #222222;
      }
      .sidebar .fa-solid.fa-chevron-down {
        font-size: 12px;
        margin-left: auto;
      }
      /* Content Wrapper & Content */
      .content-wrapper {
        flex: 1;
        display: block;
        margin: 0;
        padding: 0;
        background-color: #ecf0f5;
      }
      .content {
        background-color: #ecf0f5;
        padding-bottom: 20px;
      }
      /* XÓA CSS 8 BOX XANH */
      /* Thanh Tiêu Đề Trang (list-league) */
      .list-league {
        color: rgb(34, 34, 34);
        font-size: 24px;
        font-weight: normal;
        padding: 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: white;
        min-height: 70px;
        margin: 15px;
        border: 1px solid #d2d6de;
        border-radius: 3px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
      }
      .list-league_left {
        font-family: "Source Sans Pro", sans-serif !important;
        flex-grow: 1;
        margin-right: 15px;
      }
      .list-league i {
        margin-right: 5px;
      }
      .list-league .fa-solid.fa-list {
        color: #ff6f00;
        font-size: 22px;
      }
      /* Nút Quay lại */
      .fixture-back {
        color: rgb(255, 255, 255);
        padding: 6px 12px;
        background-color: #f34541;
        border-color: #606a72;
        border-style: solid;
        border-width: 1px;
        cursor: pointer;
        text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 0px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
        border-radius: 3px;
        font-size: 14px;
        line-height: 1.5;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        transition: background-color 0.1s ease-in-out;
        font-family: "Source Sans Pro", sans-serif;
      }
      .fixture-back:hover {
        background-color: #ff6f00;
      }
      .fixture-back i {
        margin-right: 0;
      }
      /* Content Box */
      .content-box {
        background-color: #ffffff;
        padding: 20px;
        margin: 0 15px 15px 15px;
        border-radius: 0 0 3px 3px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        border: 1px solid #d2d6de;
        border-top: 3px solid #00c0ef;
      }
      .content-box,
      .content-box label,
      .content-box input,
      .content-box select,
      .content-box button,
      .content-box option,
      .content-box div {
        font-family: "Source Sans Pro", sans-serif;
      }
      /* Score Header */
      .score-header {
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding-bottom: 20px;
        border-bottom: 1px solid #eee;
        margin-bottom: 20px;
        text-align: center;
        gap: 15px;
        flex-wrap: wrap;
      }
      .score-header .team-info {
        display: flex;
        align-items: center;
        gap: 15px;
      }
      .score-header .team-info img.team-logo {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        object-fit: cover;
        border: 1px solid #ddd;
      }
      .score-header .team-name {
        font-weight: 600;
        font-size: 18px;
      }
      .score-header input.score-input {
        width: 55px;
        height: 40px;
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 5px;
        -moz-appearance: textfield;
        appearance: textfield;
      }
      .score-header input.score-input::-webkit-outer-spin-button,
      .score-header input.score-input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      .score-header .penalty-info {
        width: 100%;
        margin-top: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
      }
      .score-header .penalty-info .penalty-label {
        font-weight: bold;
        color: #c82333;
        font-size: 14px;
        text-transform: uppercase;
      }
      .score-header .penalty-info input.penalty-score {
        width: 40px;
        height: 30px;
        font-size: 16px;
        font-weight: bold;
        text-align: center;
        border: 1px solid #ccc;
        border-radius: 4px;
        -moz-appearance: textfield;
        appearance: textfield;
      }
      .score-header
        .penalty-info
        input.penalty-score::-webkit-outer-spin-button,
      .score-header
        .penalty-info
        input.penalty-score::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      /* Stats Input Area */
      .stats-input-area {
        display: flex;
        justify-content: space-between;
        gap: 20px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }
      .team-stats-column {
        flex: 1;
        min-width: 300px;
        padding: 15px;
        border: 1px solid #eee;
        border-radius: 4px;
        background-color: #f9f9f9;
      }
      .team-stats-column h4 {
        text-align: center;
        margin-bottom: 15px;
        font-size: 16px;
        font-weight: 600;
        border-bottom: 1px solid #ddd;
        padding-bottom: 8px;
      }
      .stat-row {
        display: flex;
        gap: 8px;
        margin-bottom: 10px;
        align-items: center;
      }
      .stat-row select[name="scorer"],
      .stat-row select[name="assist"] {
        flex: 3;
      }
      .stat-row input[name="time"] {
        flex: 1;
        min-width: 50px;
      }
      .stat-row select[name="goalType"] {
        flex: 2;
      }
      .stat-row input,
      .stat-row select {
        padding: 6px 10px;
        border: 1px solid #ccc;
        border-radius: 3px;
        font-size: 13px;
        line-height: 1.42857143;
        box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
      }
      .stat-row input:focus,
      .stat-row select:focus {
        border-color: #3c8dbc;
        box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075),
          0 0 8px rgba(60, 141, 188, 0.6);
        outline: 0;
      }
      .action-btn,
      .add-row-btn {
        padding: 5px 8px;
        font-size: 12px;
        border-radius: 3px;
        cursor: pointer;
        border: 1px solid transparent;
        color: white;
        display: inline-flex;
        align-items: center;
        gap: 3px;
      }
      .stat-row button.action-btn {
        flex-shrink: 0;
      }
      .stat-row button.remove-row-btn {
        background-color: #dc3545;
        border-color: #c82333;
      }
      .stat-row button.remove-row-btn:hover {
        background-color: #c82333;
      }
      .add-row-container {
        text-align: right;
        margin-top: 10px;
      }
      button.add-row-btn {
        background-color: #28a745;
        border-color: #218838;
      }
      button.add-row-btn:hover {
        background-color: #218838;
      }
      button.add-row-btn i,
      .stat-row button.action-btn i {
        margin-right: 0;
      }
      .btn {
        padding: 6px 12px;
        border: 1px solid transparent;
        border-radius: 3px;
        cursor: pointer;
        font-size: 14px;
        text-align: center;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        font-family: "Source Sans Pro", sans-serif;
        line-height: 1.42857143;
        white-space: nowrap;
        transition: background-color 0.15s ease-in-out,
          border-color 0.15s ease-in-out;
        user-select: none;
      }
      .btn i {
        margin-right: 0;
      }
      .btn-primary {
        background-color: #3c8dbc;
        border-color: #367fa9;
        color: white;
      }
      .btn-primary:hover {
        background-color: #367fa9;
      }
      .save-button-container {
        margin-top: 30px;
        text-align: center;
        padding-top: 20px;
        border-top: 1px solid #eee;
      }
      .save-button-container .btn-save {
        padding: 10px 18px;
        font-size: 16px;
      }
      /* Footer CSS */
      .footer {
        box-sizing: border-box;
        background-color: #ecf0f5;
        color: rgb(51, 51, 51);
        font-size: 14px;
        font-weight: 500;
        text-shadow: rgb(255, 255, 255) 1px 1px 1px;
        display: block;
        margin-top: 15px;
      }
      .footer-container {
        box-sizing: border-box;
        background-color: #ecf0f5;
        color: rgb(51, 51, 51);
        font-size: 14px;
        text-shadow: rgb(255, 255, 255) 2px 2px 2px;
        margin: 0 10px 10px 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        border-top: 1px solid #d2d6de;
        line-height: normal;
      }
      .footer-left,
      .footer-right {
        flex: 1;
      }
      .footer-left p,
      .footer-right p {
        margin: 10px 0;
        line-height: 1.5;
      }
      .footer-right p i {
        margin-right: 5px;
      }
      .footer-apps {
        display: flex;
        gap: 10px;
        margin-top: 10px;
      }
      .footer-apps img {
        height: 30px;
      }
      /* Responsive adjustments */
      @media (max-width: 768px) {
        .score-header {
          justify-content: center;
        }
        .stats-input-area {
          flex-direction: column;
        }
        .team-stats-column {
          min-width: unset;
        }
      }
    </style>
  </head>
  <body>
    <header id="header-container" class="header">
      <!-- Header -->
      <div class="navbar">
        <div class="navbar-top">
          <div class="logo">
            <a href="#"><img src="/user/images/logo.png" alt="Logo" /></a>
          </div>
          <span class="developed-by"
            >Hệ thống được phát triển bởi HD Promotion</span
          >
          <div class="user-info" onclick="toggleDropdown()">
            <img src="/user/images/dhk.jpg" alt="User Avatar" />
            <span>Hải Đăng Nguyễn <i class="fa-solid fa-caret-down"></i></span>
            <div class="dropdown-menu" id="dropdownMenu">
              <a href="Dashboard.html">Trang quản lý</a>
              <a href="#">Đăng xuất</a>
            </div>
          </div>
        </div>
        <div class="navbar-bottom">
          <div class="navbar-collapse">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a href="#" class="nav-link">TRANG CHỦ</a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">GIẢI ĐANG DIỄN RA</a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">GIẢI ĐANG THEO DÕI</a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">ĐỘI BÓNG</a>
              </li>
              <li class="nav-item"><a href="#" class="nav-link">BẮT ĐỐI</a></li>
              <li class="nav-item">
                <a href="#" class="nav-link">HƯỚNG DẪN</a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link">CUỘC THI</a>
              </li>
              <li class="nav-item"><a href="#" class="nav-link">TIN TỨC</a></li>
            </ul>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <div id="sidebar-container">
        <!-- Sidebar -->
      </div>
      <div class="content-wrapper">
        <!-- === ĐÃ XÓA 8 BOX XANH === -->

        <section class="content">
          <!-- Thanh tiêu đề -->
          <div class="list-league">
            <span class="list-league_left"
              ><i class="fa-solid fa-list"></i>Thông số trận đấu</span
            >
            <a href="lichthidau.html" id="back-to-fixtures" class="fixture-back"
              ><i class="fas fa-arrow-left"></i> Quay lại Lịch thi đấu</a
            >
          </div>

          <!-- Box nội dung chính -->
          <div class="content-box">
            <!-- Score Header -->
            <div id="score-header" class="score-header">
              <div class="team-info team-a">
                <span id="teamAName" class="team-name">Đội A</span
                ><img
                  id="teamALogo"
                  src="https://via.placeholder.com/50/cccccc/FFFFFF?text=A"
                  alt="Team A Logo"
                  class="team-logo"
                /><input
                  type="number"
                  id="scoreA"
                  class="score-input"
                  min="0"
                  value="0"
                />
              </div>
              <span style="font-size: 18px; color: #555">vs</span>
              <div class="team-info team-b">
                <input
                  type="number"
                  id="scoreB"
                  class="score-input"
                  min="0"
                  value="0"
                /><img
                  id="teamBLogo"
                  src="https://via.placeholder.com/50/cccccc/FFFFFF?text=B"
                  alt="Team B Logo"
                  class="team-logo"
                /><span id="teamBName" class="team-name">Đội B</span>
              </div>
              <div class="penalty-info">
                <input
                  type="number"
                  id="penaltyA"
                  class="penalty-score"
                  min="0"
                /><span class="penalty-label">Penalty</span
                ><input
                  type="number"
                  id="penaltyB"
                  class="penalty-score"
                  min="0"
                />
              </div>
            </div>
            <!-- Stats Input Area -->
            <div id="stats-input-area" class="stats-input-area">
              <div class="team-stats-column" id="teamAStatsColumn">
                <h4 id="teamAStatsHeader">Thống kê Đội A</h4>
                <div id="teamAScoresContainer"></div>
                <div class="add-row-container">
                  <button class="add-row-btn action-btn" data-team="A">
                    <i class="fas fa-plus"></i> Thêm
                  </button>
                </div>
              </div>
              <div class="team-stats-column" id="teamBStatsColumn">
                <h4 id="teamBStatsHeader">Thống kê Đội B</h4>
                <div id="teamBScoresContainer"></div>
                <div class="add-row-container">
                  <button class="add-row-btn action-btn" data-team="B">
                    <i class="fas fa-plus"></i> Thêm
                  </button>
                </div>
              </div>
            </div>
            <!-- Save Button -->
            <div class="save-button-container">
              <button id="saveStatsBtn" class="btn btn-primary btn-save">
                <i class="fas fa-save"></i> Lưu thay đổi
              </button>
            </div>
          </div>

          <!-- Template for Stat Row (Hidden) -->
          <template id="stat-row-template">
            <div class="stat-row">
              <select name="scorer" required>
                <option value="" disabled selected>Ghi Bàn</option>
              </select>
              <select name="assist">
                <option value="" selected>Kiến Tạo</option>
              </select>
              <input type="text" name="time" placeholder="TG" size="4" />
              <select name="goalType" required>
                <option value="Bàn thắng" selected>Loại bàn</option>
                <option value="Penalty">Penalty</option>
                <option value="Phản lưới">Phản lưới</option>
              </select>
              <button class="remove-row-btn action-btn" title="Xóa dòng">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          </template>
        </section>

        <footer id="footer" class="footer">
          <!-- Footer -->
          <div class="footer-container">
            <div class="footer-left">
              <p>Bản quyền thuộc HD Promotion</p>
              <p>Nguyen Hai Dang</p>
              <p>
                Chỉ được phát hành lại nội dung khi có sự đồng ý của HD
                Promotion
              </p>
              <div class="footer-apps">
                <a href=""
                  ><img src="/user/images/logo.png" alt="IT League"
                /></a>
                <a href=""
                  ><img src="/user/images/googleplay.png" alt="Google Play"
                /></a>
                <a href=""
                  ><img src="/user/images/appstore.png" alt="App Store"
                /></a>
              </div>
            </div>
            <div class="footer-right">
              <p>
                <i class="fa fa-building" aria-hidden="true"></i> CÔNG TY CỔ
                PHẦN TỔ CHỨC SỰ KIỆN VÀ TRUYỀN THÔNG HD Promotion
              </p>
              <p>
                <i class="fa fa-map-marker" aria-hidden="true"></i> Số 185, Trần
                Đại Nghĩa, phường Đồng Tâm, quận Hai Bà Trưng, Hà Nội
              </p>
              <p><i class="fa fa-phone" aria-hidden="true"></i> 0797102555</p>
              <p>
                <i class="fa fa-envelope" aria-hidden="true"></i>
                nguyenstorm2k5@gmail.com
              </p>
            </div>
          </div>
        </footer>
      </div>
      <!-- End .content-wrapper -->
    </div>
    <!-- End .container -->

    <!-- === SCRIPT LOADING (KHÔI PHỤC SIDEBAR) === -->
    <script src="/user/js/sidebar.js"></script>
    <!-- Script riêng của sidebar -->
    <script src="/user/js/userheader.js"></script>
    <!-- Script của user header (dropdown user) -->
    <!-- Bỏ nếu không dùng componentloader.js cho header/footer
    <script src="/user/js/componentloader.js"></script>
     -->
    <!-- Bỏ script của nav đội bóng -->

    <script>
      // --- Sidebar Loading Script (KHÔI PHỤC LẠI) ---
      function initializeSidebar() {
        // Code khởi tạo sidebar của bạn (ví dụ: xử lý click menu con)
        console.log("Sidebar initialized (placeholder)");
        const menuItems = document.querySelectorAll(".sidebar .menu-item");
        menuItems.forEach((item) => {
          const submenu = item.nextElementSibling;
          if (submenu && submenu.classList.contains("submenu")) {
            item.addEventListener("click", (e) => {
              e.preventDefault();
              item.classList.toggle("active");
              submenu.style.display = item.classList.contains("active")
                ? "block"
                : "none";
            });
          }
        });
      }

      fetch("/user/sidebar.html") // Điều chỉnh đường dẫn nếu cần
        .then((response) => {
          if (!response.ok)
            throw new Error(`HTTP error! Status: ${response.status}`);
          return response.text();
        })
        .then((html) => {
          const container = document.getElementById("sidebar-container");
          if (container) {
            container.innerHTML = html;
            initializeSidebar();
          } // Gọi hàm khởi tạo
          else console.error("Sidebar container not found!");
        })
        .catch((error) => {
          console.error("Error loading sidebar:", error);
          const container = document.getElementById("sidebar-container");
          if (container)
            container.innerHTML =
              "<p style='color: #ccc;'>Error loading sidebar.</p>"; // Thông báo lỗi trong sidebar
        });

      // --- User Info Dropdown Script (Giữ nguyên) ---
      function toggleDropdown() {
        var menu = document.getElementById("dropdownMenu");
        if (menu)
          menu.style.display =
            menu.style.display === "block" ? "none" : "block";
        else console.warn("Element with ID 'dropdownMenu' not found.");
      }
      window.addEventListener("click", function (e) {
        var menu = document.getElementById("dropdownMenu");
        var userInfo = document.querySelector(".user-info");
        if (
          menu &&
          userInfo &&
          !userInfo.contains(e.target) &&
          !menu.contains(e.target)
        ) {
          menu.style.display = "none";
        }
      });

      // Script load header/footer (nếu có)
      // document.addEventListener("DOMContentLoaded", () => {
      //  try {
      //      // loadComponent('header-container', '/user/userheader.html');
      //      // loadComponent('footer', '/user/userfooter.html');
      //  } catch(error) { console.error("Error loading components:", error); }
      // });
    </script>

    <!-- === SCRIPT CHO TRANG THÔNG SỐ TRẬN ĐẤU (Giữ nguyên logic) === -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // --- Globals ---
        let currentFixture = null;
        let teamA = null;
        let teamB = null;
        let teams = [];
        let allFixtures = [];
        let allPlayers = [];
        let allScores = [];
        // --- DOM Elements ---
        const backButton = document.getElementById("back-to-fixtures");
        const scoreHeader = document.getElementById("score-header");
        const teamANameEl = document.getElementById("teamAName");
        const teamALogoEl = document.getElementById("teamALogo");
        const scoreAInput = document.getElementById("scoreA");
        const teamBNameEl = document.getElementById("teamBName");
        const teamBLogoEl = document.getElementById("teamBLogo");
        const scoreBInput = document.getElementById("scoreB");
        const penaltyAInput = document.getElementById("penaltyA");
        const penaltyBInput = document.getElementById("penaltyB");
        const teamAStatsHeaderEl = document.getElementById("teamAStatsHeader");
        const teamBStatsHeaderEl = document.getElementById("teamBStatsHeader");
        const teamAScoresContainer = document.getElementById(
          "teamAScoresContainer"
        );
        const teamBScoresContainer = document.getElementById(
          "teamBScoresContainer"
        );
        const statsInputArea = document.getElementById("stats-input-area");
        const saveStatsBtn = document.getElementById("saveStatsBtn");
        const statRowTemplate = document.getElementById("stat-row-template");
        // --- Functions ---
        function loadData() {
          const st = localStorage.getItem("teams");
          const sf = localStorage.getItem("fixtures");
          const sp = localStorage.getItem("players");
          const ss = localStorage.getItem("scores");
          teams = st ? JSON.parse(st) : getDefaultTeams();
          allFixtures = sf ? JSON.parse(sf) : [];
          allPlayers = sp ? JSON.parse(sp) : [];
          allScores = ss ? JSON.parse(ss) : [];
          if (teams.length === 0) console.warn("LS 'teams' empty.");
          if (allFixtures.length === 0) console.warn("LS 'fixtures' empty.");
          if (allPlayers.length === 0) console.warn("LS 'players' empty.");
        }
        function getDefaultTeams() {
          console.warn("Using default teams.");
          return [
            { id: "team-1", teamName: "Đội A Mẫu", logo: "..." },
            { id: "team-2", teamName: "Đội B Mẫu", logo: "..." },
          ];
        }
        function getDefaultPlayers() {
          console.warn("Using default players.");
          return [
            {
              id: "p1-1",
              teamId: "team-1",
              name: "Cầu Thủ A1",
              jerseyNumber: 10,
            },
            {
              id: "p2-1",
              teamId: "team-2",
              name: "Cầu Thủ B1",
              jerseyNumber: 9,
            },
          ];
        }
        function getTeamById(id) {
          return teams.find((t) => t.id === id);
        }
        function getFixtureById(id) {
          return allFixtures.find((f) => f.id === id);
        }
        function getPlayersByTeamId(teamId) {
          if (!allPlayers || allPlayers.length === 0) {
            allPlayers = getDefaultPlayers();
          }
          return allPlayers.filter((p) => p.teamId === teamId);
        }
        function formatDateTime(dtStr) {
          if (!dtStr) return { date: "N/A", time: "N/A" };
          try {
            const d = new Date(dtStr);
            if (isNaN(d.getTime())) return { date: "Invalid", time: "" };
            const tOpt = { hour: "2-digit", minute: "2-digit", hour12: false };
            const dOpt = { day: "2-digit", month: "2-digit", year: "numeric" };
            return {
              date: d.toLocaleDateString("vi-VN", dOpt),
              time: d.toLocaleTimeString("vi-VN", tOpt),
            };
          } catch (e) {
            console.error("Date Err:", e);
            return { date: "Err", time: "" };
          }
        }
        function populatePlayerSelect(sel, tId, inclAssistNone = false) {
          if (!sel) return;
          const pl = getPlayersByTeamId(tId);
          const fOpt = sel.options[0];
          sel.innerHTML = "";
          if (fOpt) sel.appendChild(fOpt);
          if (inclAssistNone) {
            const nOpt = document.createElement("option");
            nOpt.value = "";
            nOpt.textContent = "Không có";
            sel.appendChild(nOpt);
          }
          pl.sort((a, b) => (a.name || "").localeCompare(b.name || ""));
          pl.forEach((p) => {
            const opt = document.createElement("option");
            opt.value = p.id;
            opt.textContent = `${p.name || "N/A"} (${p.jerseyNumber || "?"})`;
            sel.appendChild(opt);
          });
        }
        function addStatRow(team, scoreData = null) {
          if (!statRowTemplate) return;
          const tId = team === "A" ? teamA?.id : teamB?.id;
          const cont =
            team === "A" ? teamAScoresContainer : teamBScoresContainer;
          if (!tId || !cont) return;
          const tmpl = statRowTemplate.content.cloneNode(true);
          const nRow = tmpl.querySelector(".stat-row");
          const scSel = nRow.querySelector('select[name="scorer"]');
          const asSel = nRow.querySelector('select[name="assist"]');
          const tiInp = nRow.querySelector('input[name="time"]');
          const tySel = nRow.querySelector('select[name="goalType"]');
          const remBtn = nRow.querySelector(".remove-row-btn");
          if (scSel) populatePlayerSelect(scSel, tId);
          if (asSel) populatePlayerSelect(asSel, tId, true);
          if (scoreData) {
            if (scSel) scSel.value = scoreData.scorerId || "";
            if (asSel) asSel.value = scoreData.assistId || "";
            if (tiInp) tiInp.value = scoreData.time || "";
            if (tySel) tySel.value = scoreData.type || "Bàn thắng";
          }
          if (remBtn)
            remBtn.addEventListener("click", () => removeStatRow(remBtn));
          cont.appendChild(nRow);
        }
        function removeStatRow(btn) {
          const row = btn.closest(".stat-row");
          if (row) row.remove();
        }
        function loadFixtureDetails() {
          if (!currentFixture) return;
          if (teamANameEl)
            teamANameEl.textContent =
              teamA?.teamName || `Đội (ID:${currentFixture.teamAId})`;
          if (teamALogoEl) {
            teamALogoEl.src = teamA?.logo || "...A";
            teamALogoEl.alt = `${teamA?.teamName || "?"} Logo`;
          }
          if (scoreAInput) scoreAInput.value = currentFixture.scoreA ?? "";
          if (teamBNameEl)
            teamBNameEl.textContent =
              teamB?.teamName || `Đội (ID:${currentFixture.teamBId})`;
          if (teamBLogoEl) {
            teamBLogoEl.src = teamB?.logo || "...B";
            teamBLogoEl.alt = `${teamB?.teamName || "?"} Logo`;
          }
          if (scoreBInput) scoreBInput.value = currentFixture.scoreB ?? "";
          if (penaltyAInput)
            penaltyAInput.value = currentFixture.penaltyA ?? "";
          if (penaltyBInput)
            penaltyBInput.value = currentFixture.penaltyB ?? "";
          if (teamAStatsHeaderEl)
            teamAStatsHeaderEl.textContent = `Thống kê ${
              teamA?.teamName || "Đội A"
            }`;
          if (teamBStatsHeaderEl)
            teamBStatsHeaderEl.textContent = `Thống kê ${
              teamB?.teamName || "Đội B"
            }`;
          if (teamAScoresContainer) teamAScoresContainer.innerHTML = "";
          if (teamBScoresContainer) teamBScoresContainer.innerHTML = "";
          if (!teamA || !teamB) {
            console.warn("Team info incomplete.");
            if (statsInputArea) statsInputArea.style.display = "none";
            return;
          } else {
            if (statsInputArea) statsInputArea.style.display = "flex";
          }
          const fixScores = allScores.filter(
            (s) => s.fixtureId === currentFixture.id
          );
          fixScores.forEach((s) => {
            if (s.teamId === teamA.id) addStatRow("A", s);
            else if (s.teamId === teamB.id) addStatRow("B", s);
          });
          if (
            teamAScoresContainer &&
            teamAScoresContainer.children.length === 0
          )
            addStatRow("A");
          if (
            teamBScoresContainer &&
            teamBScoresContainer.children.length === 0
          )
            addStatRow("B");
        }
        function handleSaveStats() {
          if (!currentFixture) {
            alert("Lỗi: No fixture.");
            return;
          }
          const fixIdx = allFixtures.findIndex(
            (f) => f.id === currentFixture.id
          );
          if (fixIdx === -1) {
            alert("Lỗi: Fixture not found.");
            return;
          }
          const scA =
            scoreAInput.value !== "" ? parseInt(scoreAInput.value, 10) : null;
          const scB =
            scoreBInput.value !== "" ? parseInt(scoreBInput.value, 10) : null;
          const penA =
            penaltyAInput.value !== ""
              ? parseInt(penaltyAInput.value, 10)
              : null;
          const penB =
            penaltyBInput.value !== ""
              ? parseInt(penaltyBInput.value, 10)
              : null;
          allFixtures[fixIdx].scoreA = scA !== null && !isNaN(scA) ? scA : null;
          allFixtures[fixIdx].scoreB = scB !== null && !isNaN(scB) ? scB : null;
          allFixtures[fixIdx].penaltyA =
            penA !== null && !isNaN(penA) ? penA : null;
          allFixtures[fixIdx].penaltyB =
            penB !== null && !isNaN(penB) ? penB : null;
          const newScores = [];
          const procTeam = (cont, tId) => {
            if (!cont || !tId) return;
            const rows = cont.querySelectorAll(".stat-row");
            rows.forEach((r) => {
              const scSel = r.querySelector('select[name="scorer"]');
              const asSel = r.querySelector('select[name="assist"]');
              const tiIn = r.querySelector('input[name="time"]');
              const tySel = r.querySelector('select[name="goalType"]');
              if (!scSel || !asSel || !tiIn || !tySel) return;
              const scId = scSel.value;
              const asId = asSel.value;
              const time = tiIn.value.trim();
              const type = tySel.value;
              if (scId) {
                newScores.push({
                  scoreId: `score-${Date.now()}-${Math.random()
                    .toString(16)
                    .slice(2)}`,
                  fixtureId: currentFixture.id,
                  teamId: tId,
                  scorerId: scId,
                  assistId: asId || null,
                  time: time,
                  type: type,
                });
              }
            });
          };
          procTeam(teamAScoresContainer, teamA?.id);
          procTeam(teamBScoresContainer, teamB?.id);
          allScores = allScores.filter(
            (s) => s.fixtureId !== currentFixture.id
          );
          allScores.push(...newScores);
          try {
            localStorage.setItem("fixtures", JSON.stringify(allFixtures));
            localStorage.setItem("scores", JSON.stringify(allScores));
            alert("Đã lưu!");
            currentFixture = allFixtures[fixIdx];
            loadFixtureDetails();
          } catch (e) {
            console.error("LS Error:", e);
            alert("Lỗi lưu.");
          }
        }
        function initialize() {
          loadData();
          const urlP = new URLSearchParams(window.location.search);
          const fixId = urlP.get("fixtureId");
          if (!fixId) {
            document.querySelector(".content-box").innerHTML =
              '<p style="color:red;">Missing fixtureId.</p>';
            return;
          }
          if (backButton) {
            backButton.href = "lichthidau.html";
          }
          currentFixture = getFixtureById(fixId);
          if (!currentFixture) {
            document.querySelector(
              ".content-box"
            ).innerHTML = `<p style="color:red;">Fixture not found: ${fixId}.</p>`;
            return;
          }
          teamA = getTeamById(currentFixture.teamAId);
          teamB = getTeamById(currentFixture.teamBId);
          loadFixtureDetails();
          if (saveStatsBtn)
            saveStatsBtn.addEventListener("click", handleSaveStats);
          if (statsInputArea) {
            statsInputArea.addEventListener("click", (event) => {
              if (event.target.closest(".add-row-btn")) {
                const team = event.target.closest(".add-row-btn").dataset.team;
                addStatRow(team);
              }
            });
          }
        }
        initialize();
      });
    </script>
  </body>
</html>
